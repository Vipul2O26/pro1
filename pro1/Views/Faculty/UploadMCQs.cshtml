@{
    Layout = "~/Views/Shared/_FacultyLayout.cshtml";
    ViewData["Title"] = "Upload MCQs";
    var subjectUnits = ViewBag.SubjectUnits as List<pro1.Models.SubjectUnit>;
    var semesters = ViewBag.Semesters as List<int>;
}

<h2>Upload MCQs (CSV)</h2>

<form asp-action="UploadMCQs" enctype="multipart/form-data" method="post">
    <div class="form-group">
        <label for="semester">Select Semester</label>
        <select class="form-control" name="Semester" id="semesterDropdown" required>
            <option disabled selected value="">-- Select Semester --</option>
            @foreach (var semester in semesters)
            {
                <option value="@semester">@semester</option>
            }
        </select>
    </div>

    <div class="form-group mt-3">
        <label for="subjectUnitId">Select Subject Unit</label>
        <select class="form-control" name="SubjectUnitID" id="unitDropdown" required>
            <option disabled selected value="">-- Select Subject Unit --</option>
            @foreach (var unit in subjectUnits)
            {
                <option value="@unit.ID" data-semester="@unit.Semester">
                    @($"{unit.SubjectName} - {unit.UnitName}")
                </option>
            }
        </select>
    </div>

    <div class="form-group mt-3">
        <label for="file">Select CSV File</label>
        <input type="file" name="file" class="form-control" required />
    </div>

    <button type="submit" class="btn btn-primary mt-3">Upload</button>
</form>

@section Scripts {
    <script>
        const semesterDropdown = document.getElementById('semesterDropdown');
        const unitDropdown = document.getElementById('unitDropdown');

        semesterDropdown.addEventListener('change', function () {
            const selectedSemester = this.value;
            for (let i = 0; i < unitDropdown.options.length; i++) {
                const option = unitDropdown.options[i];
                const semester = option.getAttribute('data-semester');
                if (!semester || semester === selectedSemester) {
                    option.style.display = '';
                } else {
                    option.style.display = 'none';
                }
            }
            unitDropdown.value = "";
        });
    </script>
}
